---
title: "Interactive Dashboard"
format: html
execute:
  echo: FALSE
editor: visual
html:
  fig-width: 7
  fig-height: 5
---

#### AUTHORS

Nicholas Medizza, Santiago Camargo Carrillo, Joao Aires

# Introduction

The increasing amount of data in the football world create an opportunity to implement statistic analysis in order to try to find new patterns and develop models to predict for example number of goals scored and probability of winning.

Given that our data for this project are not well suited to develope statistic model, we decided to implement a descriptive statistical analysis.

The scope of this project is to develop an interactive dashboard with the aim to help football fans navigate through different plots and tables and discover how teams across different leagues performed from the season 2014/2015 to 2019/2020.

# Data

Our data was downloaded from the website Kaggle (`https://www.kaggle.com/datasets/slehkyi/extended-football-stats-for-european-leagues-xg`) and the two main datasets that have been used are data from each given match played by teams in the top 5 european leagues for 6 seasons (from the season starting in 2014 until the one that began in 2019). The second dataset contains the final position for each league across with related information for the same years. All the columns in the dataset and their respective meaning is reported below.

The standard columns are **league**, **year**, **position**, **scored** (for goals scored), **missed** (for goals conceded), **result**, **date**, **team**, **wins** (for amount of matches won), **draws** (for amount of matches drawed), **loses** (for amount of matches lost), **pts** (for total points), **team**, **position**, **matches** (for amount of matches played) and **h_a** (stating if the match was played at home or away).

Additional metrics are:

**xG** - expected goals, which is a representation of the chances created during the match.

**xGA** - expected goals against, which is a representation of the chances created by the opponent during the match.

**npxG** - expected goals without penalties and own goals.

**npxGA** - expected goals against without penalties and own goals.

**deep** - passes completed within an estimated 20 yards of goal (crosses excluded).

**deep_allowed** - opponent passes completed within an estimated 20 yards of goal (crosses excluded).

**xpts** - expected points, representing the points earned in the match according to the chances created by both teams.

**npxGD** - difference between expected goals scored and expected goals conceded without penalties and own goals.

**ppda_coef** - passes allowed per defensive action in the opposition half (power of pressure).

**oppda_coef** - opponent passes allowed per defensive action in the opposition half (power of opponent's pressure).

**xG_diff** - difference between expected goals scored and actual goals scored.

**xGA_diff** - difference between expected goals conceded and actual goals conceded.

**xpts_diff** - difference between expected points and actual points for the match.

**"ppda_att" "ppda_def" "oppda_att" "oppda_def" MISSING THESE VARIABLES**

**DO WE WANT TO JUSTIFY THE TEXT?**

Below are reported the first rows for the two dataset.

```{r, message = FALSE}
library(tidyverse)
data_per_club <- read_csv("data/understat_per_game.csv", show_col_types = FALSE)
data_per_game <- read_csv("data/understat.com.csv", show_col_types = FALSE)

# print the dataset with information per game 
print(as_tibble(data_per_club))

# print the dataset with information per club
print(as_tibble(data_per_game))


```

First, the column names of both data frames were changed so that they were more organized and explicit to the variable they represented. Additionally, the data for the Russian league was excluded, as the interest lies in the top 5 European leagues.

As it is shown above, the dataset containing the information per game is given for each team and match. However, we don't have the information regarding which team was the opponent for each specific match. This information is contained (implicitly) in the same data, as every match appears as a duplicate for both teams. Therefore, it is easy to recover this data and create the column **opponent** to have this information now explicitly as part of the data frame.

```{r}



```

```{r}



```

# eda

**Team**

![](images/Santi,%20cummulative%20points%20comparison%20per%20match%20day.png)

![](images/Santi,%20goals%20and%20expected%20goals%20scored%20through%20season.png)

**National league**

In this part, we have analyzed how the values of the variables are spread, analyze the interactions between potential couples and choose the most relevant ones in order to get interesting and understandable results. Especially, to get a broader but brighter view of our research.

**Analysis of the team net performance according to its ranking and its evolution through the years**

First, we analyze the net performance of a team according to their ranking by using the goals difference variable. Moreover, we add the expected goals difference which, coupled with the goals difference line, will indicate performance trends all along the ranking.

![](images/Impact%20of%20overall%20team%20net%20performance%20according%20to%20ranking%20position.png)

Let's begin with it. We notice that first ranked teams over-perform because their attack and defense were better than expected. Conversely, the lowest-ranked teams under-perform. However, there is no dominant trend between middle ranked teams. So, this fact is reiterated throughout all the years and leagues (The data used comes from the Premier League season 2014/2015).

Then, we can notice that both lines decrease. It brings out that the less a team has a difference of goals, the less their ranking is. So this result brings out that teams with a strong defense and a efficient attack have great chances to be high ranked. As depicted by the plot below, this pattern is prevailing throughout all the years for the five leagues of our research.

![](images/Comparison%20of%20overall%20total%20goals%20difference%20throughout%20the%20years.png)

**Analysis on the impact of total wins (total losses) of a team on its goals scored per game (goals conceded per game)**

Next, we complement our mentioned approach by interacting the average of goals scored per game and the total wins of a team. Indeed, this approach makes the comparison between teams more "harmonious" since the total of games played are not the same in each league (this is the case of Bundesliga in which 34 games are played). (The scope of study uses the data of the Premier League for the season 2018/2019)

![](images/Study%20the%20impact%20of%20total%20wins%20on%20its%20goals%20scored%20per%20game.jpg){width="665"}

This plot shows the link between the average of goals scored per game (in overall) on the total of games won by the team. The ranking of the teams is also added which links up to our previous analyses. And the blue lign represents the average trend of the data.

Firstly, we observe that we have a positive trend. Indeed, the more a team wins games, the more it has a higher ratio of goals scored per game. As this fact is strongly supported by the average trend lign. However, it doesn't mean the link is "linear" as we can note in other data settings.

Secondly, we discern that data are more or less concentrated on different areas. In this plot, we remark an area on the upper-right for 2 teams, in the middle for 4 dots and the remaining is spread out from the middle to the lower-left part. This spread inform about the average performance among the league; the more they are equally scattered along the lign, the less there are performance gaps among the teams, which means more balance. And vice-versa.

Conversely, we analyzed the link of the average of goals conceded per game and the total loses of a team. This complement and uphold our previous result which states that the more a team wins, the more he will score in average.

![](images/avg_gconceded%20per%20total%20losses.png){width="664"}

**Analysis of a potential league champion due to its total of wins at home and away**

![](images/Home%20-%20Potential%20league%20champion%20-01.jpg){width="664"}

In this part, we used to study the total number of wins at home and away per season of for the 4 first high ranked teams. The goal is to show how much difference there is among those teams in order to assess the fairness of competition and a potential factor to determine the winner. Using both variables enable us to complement this approach. Take note of the assumption that games away are harder to win because of traveling constraints and the hostile atmosphere in the opponent's stadium. In overall, the champion wins the most at home and away games but this is not always the case.

![](images/Away%20-%20Potential%20league%20champion.jpg)

**Comparison across leagues**

**Evolution of distribution of total goals scored and expected total goals scored for each league**

![](images/Nico,%20distribution%20of%20goals%20scored.png)

**Comparison of net team performance across the leagues**

![](images/Nico,%20difference%20goals%20for%20the%20first%2010th%20teams.png)

**Comparison of average teams' pressure across the leagues**

![](images/Nico,%20Average%20team%20pressure%20within%20the%20league.png)

**Comparison of total goals scored per league and its volatility across leagues**

![](images/Nico,%20trend%20and%20avg%20goals%20scored%20volatility%20analysis%20.png)

**Comparison between average passes completed and average goals scored per match across leagues**

![](images/Nico,%20Avg%20passes%20completed%20per%20goal%20scored.png)

**Analysis of winner league prediction across leagues**

![](images/Nico,%20exp%20total%20pts%20earned.png)

# analysis

## Dashboard Presentation

As mentioned in the introduction our analysis with statistics and graphs is reported on the interactive dashboard that we have built. The dashboard is the structure with three main pages: the team page, the league page and the comparison across different leagues.

![DashBoard](Report_Dashboard_files/screenshots_Dashboard/tab.png)

### Team page

Using the sidebar provided on the left the user can choose the season's year, the league and a specific team.

![Drop Down Menu](Report_Dashboard_files/screenshots_Dashboard/drop_down_menu.png){height="300" fig-align="left"}

The first information shown are probaly the most indicative of the performance of the selected team.

Are reported the final position in the ranking, number of wins and defeated for matches played at home and away.

![Value Boxe](Report_Dashboard_files/screenshots_Dashboard/Value_boxes.png)

The second main feature is the possibility to compare the performance of the principal team with an another selected team. A table shows for these two teams their historic results. Next to it there is a table race that compares their total points along the season. It gives us an indicator on the performance relative to the other team.

![DashBoard](Report_Dashboard_files/screenshots_Dashboard/head_to_head.png)

### Nation League page

The second page aims to give an overall understanding, for each of the five leagues, on how the teams performed relative to each others. The most important metric used are the difference of goal scored per ranking position, the expected goals for a team and the expected goal against.

Selecting the year and league on the left of the dashboard, the graphs will change the information.

![League Page](Report_Dashboard_files/screenshots_Dashboard/Leagues.png)

### Comparison across leagues

The last page of this dashboard aims to take into account all the five european in order to asses which leagues performed better and which one is the most competitive.

The user can choose if to show all the leagues or only a subset of them.

At the top of the page are shown the teams that won the competition for each league, with the most principal information like number of wins, goal, expected goals etc.

![Summary table](Report_Dashboard_files/screenshots_Dashboard/Comparison_leagues.png)

![Difference of goals for the first 10th ranked teams, average pressure per league](Report_Dashboard_files/screenshots_Dashboard/comparison_across_leagues2.png)

![Trend in expected goal per match played](Report_Dashboard_files/screenshots_Dashboard/comparison_leagues_3.png)

![Total goals and total expected goals scored for each winning team, Total points and Total expected points](Report_Dashboard_files/screenshots_Dashboard/Comparison_leagues4.png)

# conclusion
